<!DOCTYPE html>
<html>
<head>
    <title>일정 입력</title>
    <meta charset="utf8">
    <link rel="stylesheet" href="MyCalendar.css">
    <script src="MyCalendar.js"></script>
</head>
<body>
    <fieldset>
        <legend><span id="date"></span>의 일정을 입력하세요.</legend>
        <label for="time">시각(0~24): </label>
        <input type="number" min="0" max="24" list="numberList" id="time" style="width: 3.5em; text-align: right;"/>시
            <datalist id="numberList">
            </datalist><br>
        <textarea name="" id="contents" cols="30" rows="5"></textarea>
        <button onclick="setSchedule()">저장&닫기</button>
    </fieldset>

    <script>
        var i = 0;
        var option = '';
        while(i<=24){
            option += `<option value="${i}">`;
            i++;
        }
        document.getElementById('numberList').innerHTML = option;

        // 현재는 한 날에 일정 하나 밖에 저장 안됨. id값을 dateId 하나로만 사용하기 때문
        // dateId 외에 개별 일정마다 시간을 추가한 contentsId 부여하여 개별 일정 구별하여 저장하기.

        document.getElementById('date').textContent = `${opener.thisYear}년 ${opener.thisMonth+1}월 ${opener.thisDate}일`;

        function setSchedule(){
            let contents = document.getElementById('contents').value;
            if(contents.length != 0){     // contents 내용 없을 때 저장 안되게 하기...  4/30에 아무 내용 없이 저장 눌렀을 때, 4/3 0시 생성 문제...
                let time = document.getElementById('time').value;
                let contentsId = '' + opener.thisYear + opener.modifyMonth(opener.thisMonth) + opener.modifyDate(opener.thisDate) + '_' + time;
                opener.storage.setItem(contentsId, contents);
                opener.deleteCalendar();
                opener.displayCalendar();   // 달력 갱신할 때 날짜와 그 날짜의 요일이 필요하다.
            }
            window.close();
        }     
    </script>
</body>
</html>